<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Content Writing Assistant - Generate Social Media & Blog Content</title>
    <meta name="description" content="AI-powered content writing assistant for creators. Generate social media posts, blog articles, newsletters, and video scripts with OpenAI.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom CSS -->
    <style>
        :root {
            --gradient-primary: linear-gradient(135deg, rgb(147 51 234), rgb(168 85 247));
            --gradient-hero: linear-gradient(135deg, rgb(147 51 234) 0%, rgb(139 92 246) 50%, rgb(196 181 253) 100%);
            --shadow-glow: 0 0 40px rgba(147, 51, 234, 0.3);
        }
        
        .bg-gradient-primary {
            background: var(--gradient-primary);
        }
        
        .bg-gradient-hero {
            background: var(--gradient-hero);
        }
        
        .shadow-glow {
            box-shadow: var(--shadow-glow);
        }
        
        .bg-gradient-hero-text {
            background: var(--gradient-hero);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .card {
            background: rgb(15 23 42);
            border: 1px solid rgb(51 65 85);
            border-radius: 0.75rem;
        }
        
        .input {
            background: rgb(30 41 59);
            border: 1px solid rgb(51 65 85);
            border-radius: 0.5rem;
            padding: 0.5rem 0.75rem;
            color: white;
            width: 100%;
        }
        
        .input:focus {
            outline: none;
            border-color: rgb(147 51 234);
            box-shadow: 0 0 0 3px rgba(147, 51, 234, 0.1);
        }
        
        .select {
            background: rgb(30 41 59);
            border: 1px solid rgb(51 65 85);
            border-radius: 0.5rem;
            padding: 0.5rem 0.75rem;
            color: white;
            width: 100%;
        }
        
        .btn {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-glow);
        }
        
        .btn-primary:hover {
            opacity: 0.9;
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid rgb(51 65 85);
            color: white;
        }
        
        .btn-outline:hover {
            background: rgb(30 41 59);
        }
        
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            background: rgb(30 41 59);
            color: rgb(148 163 184);
            border: 1px solid rgb(51 65 85);
        }
        
        .toast {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: rgb(15 23 42);
            border: 1px solid rgb(51 65 85);
            border-radius: 0.5rem;
            padding: 1rem;
            color: white;
            z-index: 1000;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            transform: translateX(100%);
            transition: transform 0.3s;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.success {
            border-color: rgb(34 197 94);
        }
        
        .toast.error {
            border-color: rgb(239 68 68);
        }
    </style>
</head>
<body class="bg-slate-900 text-white min-h-screen">
    <div class="container mx-auto p-4 max-w-6xl">
        <!-- Header -->
        <div class="text-center space-y-4 mb-8">
            <div class="inline-flex items-center gap-2 px-4 py-2 bg-gradient-hero rounded-full text-white">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                </svg>
                <span class="font-medium">AI Content Creator</span>
            </div>
            <h1 class="text-4xl font-bold bg-gradient-hero-text">
                Content Writing Assistant
            </h1>
            <p class="text-lg text-slate-400 max-w-2xl mx-auto">
                Generate ready-to-publish content for social media, blogs, newsletters, and video scripts with AI
            </p>
        </div>

        <div class="grid lg:grid-cols-2 gap-8">
            <!-- Input Form -->
            <div class="card p-6 shadow-glow">
                <div class="mb-6">
                    <h2 class="text-xl font-semibold flex items-center gap-2 mb-2">
                        <svg class="w-5 h-5 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                        Content Generator
                    </h2>
                    <p class="text-slate-400">Fill in the details below to generate amazing content</p>
                </div>

                <form id="contentForm" class="space-y-6">
                    <!-- Task Type -->
                    <div class="space-y-2">
                        <label class="block text-sm font-medium">Task Type</label>
                        <select id="task" class="select">
                            <option value="Social Caption">Social Caption</option>
                            <option value="Multi-Platform">Multi-Platform</option>
                            <option value="Blog Outline">Blog Outline</option>
                            <option value="Article">Article</option>
                            <option value="Script">Script</option>
                            <option value="Headline">Headline</option>
                            <option value="Meta">Meta</option>
                            <option value="Polish">Polish</option>
                        </select>
                    </div>

                    <!-- Context -->
                    <div class="space-y-2">
                        <label class="block text-sm font-medium">Context</label>
                        <textarea id="context" class="input min-h-[100px]" placeholder="Describe what you want to create content about..." required></textarea>
                    </div>

                    <!-- Platform, Tone, Length -->
                    <div class="grid grid-cols-3 gap-4">
                        <div class="space-y-2">
                            <label class="block text-sm font-medium">Platform</label>
                            <select id="platform" class="select">
                                <option value="Instagram">Instagram</option>
                                <option value="LinkedIn">LinkedIn</option>
                                <option value="Twitter">Twitter</option>
                                <option value="TikTok">TikTok</option>
                                <option value="YouTube">YouTube</option>
                                <option value="Generic">Generic</option>
                            </select>
                        </div>

                        <div class="space-y-2">
                            <label class="block text-sm font-medium">Tone</label>
                            <select id="tone" class="select">
                                <option value="Friendly">Friendly</option>
                                <option value="Professional">Professional</option>
                                <option value="Witty">Witty</option>
                                <option value="Inspirational">Inspirational</option>
                                <option value="Educational">Educational</option>
                                <option value="Casual">Casual</option>
                            </select>
                        </div>

                        <div class="space-y-2">
                            <label class="block text-sm font-medium">Length</label>
                            <select id="length" class="select">
                                <option value="Short">Short</option>
                                <option value="Medium">Medium</option>
                                <option value="Long">Long</option>
                            </select>
                        </div>
                    </div>

                    <!-- Keywords -->
                    <div class="space-y-2">
                        <label class="block text-sm font-medium">Keywords (comma-separated)</label>
                        <input type="text" id="keywords" class="input" placeholder="AI, content creation, social media...">
                    </div>

                    <!-- Variations -->
                    <div class="space-y-2">
                        <label class="block text-sm font-medium">Number of Variations</label>
                        <select id="variations" class="select">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3" selected>3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                    </div>

                    <!-- Generate Button -->
                    <button type="submit" id="generateBtn" class="btn btn-primary w-full text-lg py-3">
                        <svg id="sparkles" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                        <svg id="spinner" class="w-5 h-5 animate-spin hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                        </svg>
                        <span id="btnText">Generate Content</span>
                    </button>
                </form>
            </div>

            <!-- Results -->
            <div id="resultsContainer" class="space-y-6">
                <div class="card p-20 text-center">
                    <svg class="mx-auto h-12 w-12 text-slate-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    <p class="text-slate-400">Generated content will appear here</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <script>
        const OPENAI_API_KEY = OPENAI_API_KEY;
        
        let generatedContent = null;

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="font-medium">${type === 'success' ? 'Success!' : 'Error!'}</div>
                <div class="text-sm text-slate-300">${message}</div>
            `;
            
            document.getElementById('toastContainer').appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        async function copyToClipboard(text, elementId) {
            try {
                await navigator.clipboard.writeText(text);
                const copyBtn = document.getElementById(`copy-${elementId}`);
                const originalHTML = copyBtn.innerHTML;
                copyBtn.innerHTML = `
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                `;
                setTimeout(() => {
                    copyBtn.innerHTML = originalHTML;
                }, 2000);
                showToast('Content copied to clipboard!');
            } catch (error) {
                showToast('Failed to copy content', 'error');
            }
        }

        // Generate content
        async function generateContent(formData) {
            const prompt = `You are an expert content-writing assistant for creators. Your job is to generate ready-to-publish content for social media, blogs, newsletters, and short video scripts.

RULES:
1. ALWAYS return one single valid JSON object and NOTHING else (no extra text, no markdown).
2. The JSON MUST exactly follow the schema below.
3. Produce exactly ${formData.variations_requested} variations.
4. If "context" contains a URL, create a 1–2 sentence summary of the page and add that URL into safety.citation_urls.
5. If uncertain about a factual claim, set safety.needs_verification=true and avoid inventing facts.
6. If the user requests medical, legal, or financial advice, set safety.refusal=true, include refusal_reason, and return no variations.
7. Keep all text appropriate for public social media (no profanity, hate, or instructions for wrongdoing).
8. Use platform-appropriate tone, length, formatting, and CTAs.
9. For "Polish" tasks, use the provided text in context and return improved versions.

INPUT VARIABLES:
- task: ${formData.task}
- context: ${formData.context}
- platform: ${formData.platform}
- keywords: ${formData.keywords}
- tone: ${formData.tone}
- length: ${formData.length}
- constraints: ${formData.constraints}
- brand_voice: ${formData.brand_voice}
- variations_requested: ${formData.variations_requested}

REQUIRED JSON SCHEMA:
{
  "meta": {
    "task": "string",
    "platform": "string", 
    "tone": "string",
    "length": "string",
    "variations_requested": "integer",
    "generated_at": "string (ISO 8601 UTC)"
  },
  "summary": "string (<=2 sentences; if URL present summarize page)",
  "variations": [
    {
      "id": "string (v1, v2, ...)",
      "title": "string (short label)",
      "text": "string (the generated content)",
      "character_count": "integer",
      "recommended_hashtags": ["string"],
      "cta": "string",
      "notes_for_designer": "string"
    }
  ],
  "seo": {
    "suggested_headline": "string",
    "meta_description": "string (<=160 chars)"
  },
  "safety": {
    "refusal": "boolean",
    "refusal_reason": "string",
    "needs_verification": "boolean", 
    "citation_urls": ["string"]
  }
}

Generate content now following all the rules above. Return ONLY the JSON object.`;

            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${OPENAI_API_KEY}`
                },
                body: JSON.stringify({
                    model: 'gpt-4o-mini',
                    messages: [{
                        role: 'user',
                        content: prompt
                    }],
                    temperature: 0.7,
                    max_tokens: 2000
                })
            });

            if (!response.ok) {
                throw new Error(`API Error: ${response.status}`);
            }

            const data = await response.json();
            return JSON.parse(data.choices[0].message.content);
        }

        // Render results
        function renderResults(content) {
            const container = document.getElementById('resultsContainer');
            let html = '';

            // Summary
            html += `
                <div class="card p-6">
                    <h3 class="text-lg font-semibold text-purple-400 mb-3">Summary</h3>
                    <p class="text-white">${content.summary}</p>
                    ${content.safety.needs_verification ? '<span class="badge mt-2">⚠️ Needs Verification</span>' : ''}
                </div>
            `;

            // SEO
            html += `
                <div class="card p-6">
                    <h3 class="text-lg font-semibold text-purple-400 mb-3">SEO Suggestions</h3>
                    <div class="space-y-3">
                        <div>
                            <label class="text-sm font-medium text-slate-300">Headline</label>
                            <p class="text-white">${content.seo.suggested_headline}</p>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-slate-300">Meta Description</label>
                            <p class="text-white">${content.seo.meta_description}</p>
                        </div>
                    </div>
                </div>
            `;

            // Variations
            content.variations.forEach((variation) => {
                html += `
                    <div class="card p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold text-purple-400">${variation.title}</h3>
                            <button id="copy-${variation.id}" class="btn btn-outline" onclick="copyToClipboard('${variation.text.replace(/'/g, "\\'")}', '${variation.id}')">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                            </button>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="prose max-w-none text-white">
                                <p class="whitespace-pre-wrap">${variation.text}</p>
                            </div>
                            
                            <div class="flex flex-wrap gap-2">
                                ${variation.recommended_hashtags.map(hashtag => `<span class="badge">#${hashtag}</span>`).join('')}
                            </div>

                            ${variation.cta ? `
                                <div class="p-3 bg-slate-800 rounded-lg">
                                    <label class="text-xs font-medium text-slate-300">Call to Action</label>
                                    <p class="text-sm text-white">${variation.cta}</p>
                                </div>
                            ` : ''}

                            <div class="flex justify-between text-xs text-slate-400">
                                <span>Characters: ${variation.character_count}</span>
                                ${variation.notes_for_designer ? `<span>Designer Notes: ${variation.notes_for_designer}</span>` : ''}
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // Form submission
        document.getElementById('contentForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                task: document.getElementById('task').value,
                context: document.getElementById('context').value,
                platform: document.getElementById('platform').value,
                keywords: document.getElementById('keywords').value,
                tone: document.getElementById('tone').value,
                length: document.getElementById('length').value,
                constraints: '',
                brand_voice: '',
                variations_requested: parseInt(document.getElementById('variations').value)
            };

            if (!formData.context.trim()) {
                showToast('Please provide context for content generation.', 'error');
                return;
            }

            // Update button state
            const generateBtn = document.getElementById('generateBtn');
            const sparkles = document.getElementById('sparkles');
            const spinner = document.getElementById('spinner');
            const btnText = document.getElementById('btnText');
            
            generateBtn.disabled = true;
            sparkles.classList.add('hidden');
            spinner.classList.remove('hidden');
            btnText.textContent = 'Generating...';

            try {
                const content = await generateContent(formData);
                generatedContent = content;
                renderResults(content);
                showToast(`Successfully generated ${content.variations.length} variations!`);
            } catch (error) {
                console.error('Error generating content:', error);
                showToast(error.message || 'Failed to generate content. Please try again.', 'error');
            } finally {
                // Reset button state
                generateBtn.disabled = false;
                sparkles.classList.remove('hidden');
                spinner.classList.add('hidden');
                btnText.textContent = 'Generate Content';
            }
        });
    </script>
</body>
</html>
